# 近地星座构型演化仿真系统

本项目是一个功能强大的近地卫星星座仿真系统，用于研究多颗卫星在轨长期运行中构型保持与变化的规律。系统采用多种数值计算方法，实现了全面的摄动力模型、星座设计与优化功能，并提供了丰富的可视化和分析工具。

## 功能特点

### 1. 多种数值计算方法
- **自适应步长RK45**：科学计算标准方法，兼顾精度和效率
- **经典四阶龙格库塔**：固定步长的传统方法，适合精度要求较高的场合
- **速度Verlet法**：专为轨道计算优化的算法，能较好保持能量守恒
- **辛欧拉法**：保持系统哈密顿性质，适合长期轨道演化
- **欧拉法**：最简单的显式积分方法，用于方法对比

### 2. 高级摄动力模型
- **扩展地球引力场**：支持高达4阶的地球重力场模型（基于EGM2008）
- **精确大气阻力模型**：基于NRLMSISE-00模型的简化版，考虑高度、纬度和太阳活动
- **太阳辐射压力模型**：包含地球阴影和太阳位置真实计算
- **月球和太阳引力摄动**：第三体引力效应

### 3. 星座设计与优化
- **Walker星座配置**：支持设计不同规模的Walker星座
- **覆盖率分析**：评估星座对全球的覆盖性能
- **碰撞风险评估**：计算星座内部碰撞风险
- **综合性能评估**：多因素权重评分系统

### 4. 增强可视化
- **交互式3D轨道可视化**：高质量地球模型和彩色轨道线
- **轨道根数演化图**：直观展示轨道六根数随时间变化
- **摄动效应对比图**：比较不同摄动力对轨道的影响
- **覆盖率热图**：在3D地球表面显示覆盖情况

### 5. 误差分析工具
- **能量守恒误差**：分析不同方法的能量保持性能
- **角动量守恒误差**：评估角动量的保持能力
- **方法精度对比**：直观比较不同方法的精度和性能

## 文件结构

- **test2.py**：原始主程序代码
- **numerical_methods.py**：多种数值积分方法和误差分析工具
- **perturbation_models.py**：高级摄动力模型
- **visualization_enhancements.py**：可视化增强功能
- **ui_extensions.py**：用户界面扩展
- **main_enhanced.py**：增强版主程序入口

## 使用方法

### 运行基础版本

```bash
python test2.py
```

### 运行增强版本

```bash
python main_enhanced.py
```

### 基本操作流程

1. **创建星座**
   - 设置卫星总数、轨道面数、相位因子
   - 设置轨道高度、倾角和偏心率
   - 设置卫星物理参数（面积质量比、阻力系数、反射系数）
   - 点击"创建星座"按钮

2. **运行仿真**
   - 设置仿真时长和步长
   - 选择摄动选项（J2、大气阻力、太阳辐射压）
   - 选择数值计算方法
   - 点击"运行仿真"按钮

3. **分析结果**
   - 使用"分析"菜单查看轨道演化、摄动影响等
   - 使用"工具"菜单进行误差分析和星座优化
   - 使用"播放动画"观看动态演化过程

## 优化改进

与原版相比，增强版在以下方面进行了优化：

1. **计算效率**
   - 优化了大气密度插值算法，避免循环查找
   - 矢量化计算，减少循环操作
   - 使用辛积分器提高长期演化的精度

2. **数值精度**
   - 加入多种积分方法，可根据需要选择精度和效率的平衡点
   - 增加误差分析功能，直观比较不同方法的性能
   - 提供轨道保守量检查，确保长期演化的物理合理性

3. **可视化效果**
   - 高质量3D地球模型，包含经纬网格
   - 轨迹彩色渐变，直观展示时间演化
   - 多种图表展示数据，包括热图、柱状图和曲线图

4. **用户体验**
   - 添加菜单栏，整合功能
   - 提供数据导出功能
   - 增加配置保存和加载功能

## 开发者信息

本系统是对原有程序的重构和增强，旨在提供更全面、精确的近地星座演化模拟工具。系统设计遵循模块化原则，便于未来扩展和维护。

## 系统要求

- Python 3.7+
- NumPy, SciPy, Matplotlib, Pandas
- Tkinter (GUI界面)
- Seaborn (可选，用于高级绘图)

## 数据输出

仿真结果将保存在`results`目录下，包括：
- 星座状态数据
- 参数配置
- 轨道演化数据
- 误差分析报告

## 系统改进

### 最新优化：
1. **星座优化显示坐标比例修复**
   - 修正了最优星座配置可视化中的坐标比例问题
   - 确保3D视图中的XYZ轴比例一致，提供真实的空间透视效果

2. **RK45方法性能优化**
   - 修复了RK45方法运行时间长的问题
   - 添加合理的默认参数设置，避免无限迭代
   - 提供备用积分方法，确保计算可靠性

3. **多线程和并行计算支持**
   - 新增并行计算模块，支持多线程和多进程
   - 优化CPU利用率，加速星座分析和优化过程
   - 高效内存管理和向量化计算

## 新增模块

1. **星座优化模块 (constellation_optimization.py)**
   - 高效的星座设计和优化工具
   - 支持多线程并行计算Walker星座优化
   - 提供优化结果可视化功能

2. **并行计算模块 (parallel_computing.py)**
   - 提供多线程和多进程计算支持
   - 内存优化工具和向量化计算方法
   - 高效的并行Map-Reduce模式实现

3. **星座分析模块 (constellation_analysis.py)**
   - 高效的星座性能评估工具
   - 并行计算覆盖率和碰撞风险
   - 重访时间分析和星座几何配置评估

## 使用指南

### 星座优化
使用新的星座优化功能可以快速找到满足特定需求的最优星座配置：
1. 在主界面点击"星座优化"按钮
2. 设置优化参数（卫星数量范围、轨道平面数、倾角和高度等）
3. 选择是否启用多进程加速计算
4. 点击"运行优化"按钮开始优化过程
5. 查看优化结果和3D可视化效果
6. 可选择"应用最优配置"到主界面

### 高效仿真
利用改进的数值积分方法进行更高效的轨道传播：
1. 选择"RK45"方法进行自适应步长积分
2. 系统自动设置合理的参数，避免计算过慢
3. 复杂场景下，可尝试使用Verlet或Symplectic方法获得更好的长期稳定性

### 并行计算
启用多线程优化可以显著提高大型星座分析和优化的速度：
1. 在星座优化界面选择"使用多进程加速计算"
2. 系统会自动分配任务到多个CPU核心
3. 进度条实时显示计算进展

## 系统要求
- Python 3.7+
- NumPy, SciPy, Matplotlib
- 多核CPU（推荐4核或以上）
- 至少4GB内存（大型星座优化建议8GB以上） #

